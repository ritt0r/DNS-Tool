<?php
$whoisServers = array(
    'ac' => 'whois.nic.ac',
    'ae' => 'whois.aeda.net.ae',
    'ag' => 'whois.nic.ag',
    'am' => 'whois.nic.am',
    'as' => 'whois.nic.as',
    'asia' => 'whois.nic.asia',
    'at' => 'whois.nic.at',
    'au' => 'whois.aunic.net',
    'bg' => 'whois.digsys.bg',
    'bj' => 'whois.nic.bj',
    'br' => 'whois.nic.br',
    'bz' => 'whois.belizenic.bz',
    'ca' => 'whois.cira.ca',
    'cd' => 'whois.nic.cd',
    'cl' => 'whois.nic.cl',
    'ck' => 'whois.nic.ck',
    'cm' => 'whois.ripe',
    'cn' => 'whois.cnnic.net.cn',
    'cx' => 'whois.nic.cx',
    'cz' => 'whois.nic.cz',
    'dk' => 'whois.dk-hostmaster.dk',
    'dm' => 'whois.nic.dm',
    'ee' => 'whois.eenet.ee',
    'fi' => 'whois.ficora.fi',
    'fj' => 'whois.usp.ac.fj',
    'fo' => 'whois.ripe.net',
    'fr' => 'whois.nic.fr',
    'gd' => 'whois.adamsnames.tc',
    'gg' => 'whois.channelisles.net',
    'gl' => 'whois.ripe.net',
    'gm' => 'whois.ripe.net',
    'gs' => 'whois.adamsnames.tc',
    'hk' => 'whois.hkdnr.net.hk',
    'hm' => 'whois.registry.hm',
    'hn' => 'whois2.afilias-grs.net',
    'hu' => 'whois.nic.hu',
    'id' => 'whois.netzone.web.id',
    'ie' => 'whois.domainregistry.ie',
    'il' => 'whois.isoc.org.il',
    'in' => 'whois.inregistry.net',
    'io' => 'whois.nic.io',
    'ir' => 'whois.nic.ir',
    'is' => 'whois.isnet.is',
    'it' => 'whois.nic.it',
    'je' => 'whois.channelisles.net',
    'jobs' => 'jobswhois.verisign-grs.com',
    'jp' => 'whois.jprs.jp',
    'ke' => 'whois.kenic.or.ke',
    'kr' => 'whois.krnic.net',
    'kz' => 'whois.nic.kz',
    'la' => 'whois.nic.la',
    'lt' => 'whois.ripe.net',
    'ly' => 'whois.nic.ly',
    'lv' => 'whois.ripe.net',
    'ma' => 'whois.iam.net.ma',
    'mc' => 'whois.ripe.net',
    'me' => 'whois.meregistry.net',
    'mn' => 'whois.nic.mn',
    'mobi' => 'whois.dotmobiregistry.net',
    'ms' => 'whois.adamsnames.tc',
    'mt' => 'whois.nic.org.mt',
    'mu' => 'whois.nic.mu',
    'mx' => 'whois.nic.mx',
    'my' => 'whois.mynic.net.my',
    'na' => 'whois.na-nic.com.na',
    'nf' => 'whois.nic.cx',
    'no' => 'whois.norid.no',
    'nu' => 'whois.nic.nu',
    'pl' => 'whois.dns.pl',
    'pro' => 'whois.registrypro.pro',
    'pt' => 'whois.dns.pt',
    'nz' => 'whois.domainz.net.nz',
    'pm' => 'whois.nic.fr',
    're' => 'whois.nic.fr',
    'ro' => 'whois.rotld.ro',
    'ru' => 'whois.ripn.ru',
    'sb' => 'whois.nic.net.sb',
    'sc' => 'whois2.afilias-grs.net',
    'se' => 'whois.nic-se.se',
    'sg' => 'whois.nic.net.sg',
    'sh' => 'whois.nic.sh',
    'si' => 'whois.arnes.si',
    'sk' => 'whois.sk-nic.sk',
    'sm' => 'whois.ripe.net',
    'st' => 'whois.nic.st',
    'su' => 'whois.ripn.net',
    'tc' => 'whois.adamsnames.tc',
    'tel' => 'whois.nic.tel',
    'tf' => 'whois.adamsnames.tc',
    'th' => 'whois.thnic.net',
    'tj' => 'whois.nic.tj',
    'tk' => 'whois.dot.tk',
    'tl' => 'whois.nic.tl',
    'tm' => 'whois.nic.tm',
    'to' => 'whois.tonic.to',
    'tp' => 'whois.nic.tl',
    'tr' => 'whois.metu.edu.tr',
    'travel' => 'whois.nic.travel',
    'tv' => 'whois.nic.tv',
    'tw' => 'whois.twnic.net.tw',
    'ua' => 'whois.com.ua',
    'ug' => 'whois.co.ug',
    'ug' => 'whois.co.ug',
    'uk' => 'whois.nic.uk',
    'co' => 'whois.uk.co',
    'us' => 'whois.nic.us',
    'uy' => 'nic.uy',
    'uz' => 'whois.cctld.uz',
    'va' => 'whois.ripe.net',
    'vc' => 'whois2.afilias-grs.net',
    've' => 'whois.nic.ve',
    've' => 'whois.nic.ve',
    'vg' => 'whois.adamsnames.tc',
    'ws' => 'whois.nic.ws',
    'uz' => 'whois.cctld.uz',
    'aero' => 'whois.information.aero',
    'com' => 'whois.crsnic.net',
    'net' => 'whois.crsnic.net',
    'org' => 'whois.publicinterestregistry.net',
    'info' => 'whois.afilias.net',
    'museum' => 'whois.museum',
    'name' => 'whois.nic.name',
    'biz' => 'whois.neulevel.biz',
    'cc' => 'whois.nic.cc',
    'edu' => 'whois.educause.net',
    'mil' => 'whois.nic.mil',
    'int' => 'whois.iana.org',
    'coop' => 'whois.nic.coop',
    'gov' => 'whois.dotgov.gov',
    'ch' => 'whois.nic.ch',
    'swiss' => 'whois.nic.swiss',
);
$hosters = array(
    '/ns[0-9]?.ch-inter.net/' => array(
        'title' => 'METANET Managed DNS',
        'description' => 'DNS managed by METANET. Changes can be seen and made via PLESK or mail to METANET. Zone is only visible in PLESK via import.',
        'icon' => 'https://www.metanet.ch/images/svg/logo.svg',
    ),
    '/(?:ch|nl|de).ch-inter.net/' => array(
        'title' => 'METANET DNS Cloud',
        'description' => 'Separate DNS management platform from METANET.',
        'icon' => 'https://www.metanet.ch/images/svg/logo.svg',
    ),
    '/sui-inter.net$|metanet.ch$/' => array(
        'title' => 'METANET hosting',
        'description' => '',
        'icon' => 'https://www.metanet.ch/images/svg/logo.svg',
    ),
    '/pro.io$|dnh.net$/' => array(
        'title' => 'METANET DNS',
        'description' => '',
        'icon' => 'https://www.metanet.ch/images/svg/logo.svg',
    ),
    '/dns.dns[0-9].de/' => array(
        'title' => 'Partnergate DNS',
        'description' => '',
        'icon' => 'https://www.partnergate.com/wp-content/uploads/2020/01/PartnerGate_Logo-1.png',
    ),
    '/mail.protection.outlook.com/' => array(
        'title' => 'Office 365 mail',
        'description' => '',
	'icon' => 'https://support.content.office.net/en-us/media/bf3cb7f2-78c0-42e9-a066-5aec163f95c4.png',
    ),
    '/de-nserver.de/' => array(
        'title' => 'Profihost',
        'description' => '',
    ),
    '/hoststar.hosting|loginserver.ch/' => array(
        'title' => 'Hoststar',
        'description' => 'Expect weird things',
        'icon' => 'https://www.hoststar.ch/sites/all/themes/hoststar/images/icons/svg/fallback/hs-logo-dark.png',
    ),
    '/anydns\d+.trendhosting-net.ch/' => array(
        'title' => 'Trendhosting ANYCAST DNS',
        'description' => '<a href=\'https://www.trendhosting.ch/unternehmen/portrait/trendhosting-anycast-dns/\'>Trendhosting ANYCAST DNS</a>',
        'icon' => 'https://www.trendhosting.ch/fileadmin/framework/images/trendhosting_logo.png',
    ),
    '/trendhosting.cloud/' => array(
        'title' => 'Trendhosting Cloud',
        'description' => '',
        'icon' => 'https://www.trendhosting.ch/fileadmin/framework/images/trendhosting_logo.png',
    ),
    '/trendhosting-net.ch/' => array(
        'title' => 'Trendhosting',
        'description' => '',
        'icon' => 'https://www.trendhosting.ch/fileadmin/framework/images/trendhosting_logo.png',
    ),
    '/infomaniak.ch|mhs.ch/' => array(
        'title' => 'Infomaniak',
        'description' => '',
    ),
    '/firestorm.ch|firestorm-isp.com|mailgw[0-9].gimsx.ch/' => array(
        'title' => 'Firestorm',
        'description' => '',
    ),
    '/hosttech.eu/' => array(
        'title' => 'Hosttech',
        'description' => '',
    ),
    '/googlemail.com|aspmx.l.google.com/' => array(
        'title' => 'Google',
        'description' => '',
    ),
    '/cloudflare.com/' => array(
        'title' => 'Cloudflare',
        'description' => 'Reverse proxy / DNS provider',
    ),
    '/cloudfront.net/' => array(
        'title' => 'AWS Cloudfront',
        'description' => 'Reverse proxy',
        'icon' => 'https://a0.awsstatic.com/libra-css/images/logos/aws_smile-header-desktop-en-white_59x35.png',
    ),
    '/ns-[0-9]+.awsdns-[0-9]+.(?:org|net|com|co.uk)/' => array(
        'title' => 'AWS DNS',
        'description' => '',
        'icon' => 'https://a0.awsstatic.com/libra-css/images/logos/aws_smile-header-desktop-en-white_59x35.png',
    ),
    '/amazonaws.com/' => array(
        'title' => 'Amazon AWS',
        'description' => '',
        'icon' => 'https://a0.awsstatic.com/libra-css/images/logos/aws_smile-header-desktop-en-white_59x35.png',
    ),
    '/azure-dns.info|microsoftonline.com/' => array(
        'title' => 'Microsoft Azure DNS',
        'description' => '',
    ),
    '/akam.net/' => array(
        'title' => 'Akamai Technologies',
        'description' => 'CDN / DNS provider',
        'icon' => 'https://www.akamai.com/us/en/multimedia/images/logo/akamai-logo.png',
    ),
    '/talus.ch/' => array(
        'title' => 'Talus',
        'description' => 'IT Dienstleister für Verwaltungen',
        'icon' => 'https://www.talus.ch/wGlobal/wGlobal/layout/images/LOGtalus_farbig.svg',
    ),
    '/infopro.ch/' => array(
        'title' => 'Infopro',
        'description' => 'IT Dienstleister für KMUs',
        'icon' => 'https://www.infopro.ch/wp-content/uploads/2020/11/Logo-Infopro-2018_edit_cut_white.svg',
    ),
    '/all-cloud.ch/' => array(
        'title' => 'All Consulting',
        'description' => 'Consulting der UMB',
        'icon' => 'https://all-consulting.ch/wp-content/uploads/2019/03/AC_300px.jpg',
    ),
    '/cyon.(?:net|ch)/' => array(
        'title' => 'CYON',
        'description' => 'Hoster',
        'icon' => 'https://www.cyon.ch/svg/cyon-logo.svg',
    ),
    '/nitrado.net/' => array(
        'title' => 'Nitrade',
        'description' => 'Gaming hoster',
        'icon' => 'https://static.nitrado.net/cdn/icons/png/256/nitradologo_ni.png',
    ),
);
function whois($domain, $whoisServers) {
    $tld = end(explode('.', $domain));
    if (isset($whoisServers[$tld])) {
        $whoisServer = $whoisServers[$tld];
    } else {
        $resp = _whois($tld, 'whois.iana.org');
        $resp = str_replace("\n", "<br>", $resp);
        $whois = str_replace("\r", "<br>", $resp);
        $matches = array();
        preg_match('/[Ww]hois:(?:<br>| )([A-Za-z0-9-_ .]+)(?:<br>|$)/', $whois, $matches);
        if (isset($matches[1])) {
            $whoisServer = trim($matches[1]);
        }
    }
    if (empty($whoisServer)) {
        return null;
    }
    return _whois($domain, $whoisServer);
}
function _whois($domain, $server) {
    if ($conn = fsockopen ($server, 43)) {
        fputs($conn, $domain . "\r\n");

        while(!feof($conn)) {
            $output .= fgets($conn,128);
        }

        fclose($conn);
        return $output;
    } else {
        $errors = array(); 
        $errors['invalid_connection'] = 'We were unable to connect to the ' . $whois['nic_server'] . ' server. <a href="javascript:history.back()">Try again</a>.';
        return null;
    }
}
function authorativeDns($ip, $recordType, $dnsServer) {
    // random transaction number (for routers etc to get the reply back)
    $data = rand(0, 99);
    // trim it to 2 bytes
    $requestId = substr($data, 0, 2);
    // request header
    $data = $requestId . "\1\0\0\1\0\0\0\0\0\0";
    // split IP up
    $bits = explode(".", $ip);
    // error checking
    //if (count($bits) != 4) return "ERROR";
    // there is probably a better way to do this bit...
    // loop through each segment
    for ($x=count($bits) - 1; $x>=0; $x--)
    {
        // needs a byte to indicate the length of each segment of the request
        $data .= chr(strlen($bits[x]));
        // and the segment itself
        $data .= $bits[$x];
    }
    // and the final bit of the request
    switch ($recordType) {
        case 'A':
            $data .= "\0\0\0\0\1";
            break;
        case 'MX':
            $data .= "\0\0\15\0\1";
            break;
        case 'NS':
            $data .= "\0\0\2\0\1";
            break;
        case 'TXT':
            $data .= "\0\0\16\0\1";
            break;
        case 'PTR':
            $data .= "\7in-addr\4arpa\0\0\x0C\0\1";
            break;
        default:
            throw new \Exception('Type not (yet) implemented');
            break;
    }
    // create UDP socket
    $handle = @fsockopen("udp://$dnsServer", 53);
    // send our request (and store request size so we can cheat later)
    $requestsize=@fwrite($handle, $data);

    $response = @fread($handle, 1000);
    @fclose($handle);
    if ($response == "")
        return $ip;
    // find the response type
    //$name = unpack(
    $type = @unpack("s", substr($response, $requestsize+2));
    if ($type[1] == 0x0C00)  // answer
    {
        // set up our variables
        $host="";
        $len = 0;
        // set our pointer at the beginning of the hostname
        // uses the request size from earlier rather than work it out
        $position=$requestsize+12;
        // reconstruct hostname
        do
        {
            // get segment size
            $len = unpack("c", substr($response, $position));
            // null terminated string, so length 0 = finished
            if ($len[1] == 0)
                // return the hostname, without the trailing .
                return substr($host, 0, strlen($host) -1);
            // add segment to our host
            $host .= substr($response, $position+1, $len[1]) . ".";
            // move pointer on to the next segment
            $position += $len[1] + 1;
        }
        while ($len != 0);
        // error - return the hostname we constructed (without the . on the end)
        return $ip;
    }
    /*for ($i = 0; $i < strlen($response); $i++) {
        var_dump(unpack('c', $response[$i]));
    }*/
    return $ip;
}
// TODO: Find a better way to check for AJAX
if (!empty($_GET['domain'])) {
    $hostingIp = $_GET['domain'];
    $isIp = true;
    if (!filter_var($_GET['domain'], FILTER_VALIDATE_IP)) {
        $isIp = false;
        $_GET['domain'] = idn_to_ascii($_GET['domain']);
        $hostingIp = gethostbyname($_GET['domain']);
    }

    // hoster
    $hostingDns = gethostbyaddr($hostingIp);
    foreach ($hosters as $regex=>$hosterInfo) {
        if (preg_match($regex, $hostingDns)) {
            $hostingInfo = $hosterInfo;
            break;
        }
    }

    if (!$isIp) {
        // a records
        // TODO: The idea here is to get the TTL from the authorative server...
        //$aRecords = dns_get_record($_GET['domain'], DNS_A);

        // ns
        $nameserverRecords = dns_get_record($_GET['domain'], DNS_NS);
        $nameservers = array();
        $dnsHoster = array();
        foreach ($nameserverRecords as $nameserverRecord) {
            $nameservers[] = array(
                'host' => $nameserverRecord['target'],
                //'ttl' => $nameserverRecord['ttl'],
            );
        }
        foreach ($hosters as $regex=>$hosterInfo) {
            if (preg_match($regex, current($nameservers)['host'])) {
                $dnsHoster = $hosterInfo;
                break;
            }
        }
        $nsHosterRevDns = '';
        if (count($nameservers)) {
            $nsHosterRevDns = gethostbyaddr(gethostbyname(current($nameservers)['host']));
        }
        if (!count($dnsHoster) && !empty($nsHosterRevDns)) {
            foreach ($hosters as $regex=>$hosterInfo) {
                if (preg_match($regex, $nsHosterRevDns)) {
                    $dnsHoster = $hosterInfo;
                    break;
                }
            }
        }

        // mx
        $mxRecords = dns_get_record($_GET['domain'], DNS_MX);
        $mxs = array();
        $mxHoster = array();
        foreach ($mxRecords as $mxRecord) {
            $mxs[] = array(
                'host' => $mxRecord['target'],
                'priority' => $mxRecord['pri'],
                //'ttl' => $mxRecord['ttl'],
            );
        }
        foreach ($hosters as $regex=>$hosterInfo) {
            if (preg_match($regex, current($mxs)['host'])) {
                $mxHoster = $hosterInfo;
                break;
            }
        }
        $mxHosterRevDns = '';
        if (count($mxs)) {
            $mxHosterRevDns = gethostbyaddr(gethostbyname(current($mxs)['host']));
        }
        if (!count($mxHoster) && !empty($mxHosterRevDns)) {
            foreach ($hosters as $regex=>$hosterInfo) {
                if (preg_match($regex, $mxHosterRevDns)) {
                    $mxHoster = $hosterInfo;
                    break;
                }
            }
        }
        $txtRecords = dns_get_record($_GET['domain'], DNS_TXT);
        $spfRecord = '';
        $dkimRecord = '';
        $dmarcRecord = '';
        foreach ($txtRecords as $txtRecord) {
            if (preg_match('/spf/', $txtRecord['txt'])) {
                $spfRecord = $txtRecord['txt'];
                break;
            }
        }
        $dmarcRecords = dns_get_record('_dmarc.' . $_GET['domain'], DNS_TXT);
        if (count($dmarcRecords)) {
            $dmarcRecord = current($dmarcRecords)['txt'];
        }
        $dkimRecords = dns_get_record('mail._domainkey.' . $_GET['domain'], DNS_TXT);
        if (count($dkimRecords)) {
            $dkimRecord = current($dkimRecords)['txt'];
        }

        // whois
        $output = whois($_GET['domain'], $whoisServers);
        $output = str_replace("\n", "<br>", $output);
        $whois = str_replace("\r", "<br>", $output);
        $matches = array();
        preg_match('/[Rr]egistrar:(?:<br>| )([A-Za-z0-9-_ ,.]+)(?:<br>|$)/', $whois, $matches);
        $registrar = $matches[1];
    }

    // authorative answers
    //$authMail = authorativeDns($_GET['domain'], 'MX', current($nameservers)['host']);
    //var_dump($authMail);die();

    //var_dump(authorativeDns($hostingIp, 'PTR', '8.8.8.8'));die();

    // output
    echo json_encode(array(
        'hoster' => array(
            'host_ip' => $hostingIp,
            'host_dns' => $hostingDns,
            'info' => $hostingInfo,
        ),
        'mail' => array(
            'mx' => $mxs,
            'revDns' => $mxHosterRevDns,
            'spf' => $spfRecord,
            'dkim' => array(
                'value' => $dkimRecord,
                'tooltip' => 'DKIM records cannot be gathered consistently. If this is empty it does not mean that DKIM is not configured.',
            ),
            'dmarc' => $dmarcRecord,
            'info' => $mxHoster,
        ),
        'dns' => array(
            'nameserver' => $nameservers,
            'revDns' => $nsHosterRevDns,
            'info' => $dnsHoster,
        ),
        'whois' => array(
            'registrar' => $registrar,
            'raw' => $whois,
        ),
    ));
    die();
}
echo '
<html>
    <head>
        <title>DNS-Tool</title>
        <style type="text/css">
            table {
                border-spacing: 20px 0;
            }

            table tr.spacer {
                height: 20px;
            }

            table tr td {
                vertical-align: top;
            }

            table tr td.collapsible {
                overflow: hidden;
                position: absolute;
                cursor: pointer;
            }

            table tr td.collapsible:before {
                content: "^ Click to collapse";
                color: blue;
                text-decoration: underline;
                display: block;
            }

            table tr td.collapsible.collapsed {
                height: 1em;
                color: white;
            }

            table tr td.collapsible.collapsed:before {
                content: "v Click to unfold";
            }

            table tr td:last-child {
                font-family: monospace;
            }

            table tr td:first-child:not(:empty) {
                font-weight: bold;
            }

            img {
                background-color: #AAAAAA;
                max-height: 1.5em;
                max-width: 100px;
            }

            div.tooltip {
                display: inline-block;
            }

            div.tooltip::before {
                content: "i";
                color: white;
                background-color: dodgerblue;
                height: 1em;
                width: 1em;
                border-radius: 50%;
                display: inline-block;
                text-align: center;
                box-shadow: black 0 0 4px;
            }

            div.tooltip div {
                display: inline-block;
                visibility: hidden;
                opacity: 0;
                position: absolute;
                color: black;
                margin-top: -0.5em;
                margin-left: 1em;
                background: white;
                border-style: solid;
                border-width: 1px;
                border-color: black;
                border-radius: 5px;
                padding: 0.3em;
                box-shadow: gray 3px 3px 5px;
                transition: visibility 0s 2s, opacity 0.2s;
            }

            div.tooltip:hover div {
                opacity: 1;
                visibility: visible;
                transition: visibility 0s 0s, opacity 0.2s;
            }
        </style>
    </head>
    <body>
        <form>
            <label for="domain">Domain:</label><input id="domain" type="text" name="domain" />
            <input type="submit" />
        </form>
        <p>All DNS results are non-authorative!</p>
        <pre id="result"></pre>
        <div id="resultTable"></div>
        <script type="text/javascript">
            document.querySelector("form").addEventListener("submit", function(e) {
                e.preventDefault();

                const tableParent = document.querySelector("#resultTable");
                tableParent.innerHTML = "";

                var xhr = new XMLHttpRequest();
                xhr.onload = function () {
                    // Process our return data
                    if (xhr.status >= 200 && xhr.status < 300) {
                        // Runs when the request is successful
                        var res = JSON.parse(xhr.responseText);
                        //document.querySelector("#result").innerHTML = JSON.stringify(res, null, 4);
                        const table = document.createElement("table");

                        var i = 0;
                        for (const title in res) {
                            var j = 0;
                            for (const subtitle in res[title]) {
                                if (j == 0 && i > 0) {
                                    var spacerRow = table.insertRow(-1);
                                    spacerRow.classList.add("spacer");
                                    spacerRow.insertCell(-1);
                                    spacerRow.insertCell(-1);
                                    spacerRow.insertCell(-1);
                                }
                                var row = table.insertRow(-1);
                                var firstCell = row.insertCell(-1);
                                var secondCell = row.insertCell(-1);
                                var thirdCell = row.insertCell(-1);
                                if (j == 0) {
                                    firstCell.innerHTML = title;
                                }
                                secondCell.innerHTML = subtitle;
                                var data = res[title][subtitle];
                                if (subtitle == "raw") {
                                    thirdCell.classList.add("collapsed");
                                    thirdCell.classList.add("collapsible");
                                }
                                if (!data) {
                                } else if (typeof data == "object") {
                                    var result = "";
                                    if (data.hasOwnProperty("icon")) {
                                        result = "<img src=\"" + data.icon + "\" />";
                                        delete data.icon;
                                    }
                                    if (data.hasOwnProperty("value") && data.hasOwnProperty("tooltip")) {
                                        var tooltip = data.tooltip;
                                        secondCell.innerHTML = secondCell.innerHTML + " <div class=\"tooltip\"><div>" + tooltip + "</div></div>";
                                        data = data.value;
                                    }
                                    result += JSON.stringify(data, null, 4);
                                    thirdCell.innerHTML = result;
                                } else {
                                    thirdCell.innerHTML = data;
                                }
                                j++;
                            }
                            i++;
                        }
                        tableParent.appendChild(table);
                        document.querySelectorAll(".collapsible").forEach(function(el) {
                            el.addEventListener("click", function(e) {
                                e.target.classList.toggle("collapsed");
                            });
                        });
                    } else {
                        // Runs when it\'s not
                        console.log(xhr.responseText);
                        tableParent.innerHTML = "Error: " + xhr.responseText;
                    }
                };
                xhr.onreadystatechange = () => {
                    if (xhr.status === 404) {
                        console.log(xhr.responseText);
                        tableParent.innerHTML = "Error: " + xhr.responseText;
                    }
                };
                xhr.open("GET", "dns.php?domain=" + document.querySelector("input[type=text]").value);
                xhr.send();
            });
            document.querySelector("input[type=text]").focus();
        </script>
    </body>
</html>
';
